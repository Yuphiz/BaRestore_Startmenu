# 备份和还原开始菜单

本工具可以备份/还原win10和win11的开始菜单，全网首先支持备份win11的分组开始菜单

支持备份部分任务栏/win10工具栏，部分explorer选项

​<img src="https://github.com/Yuphiz/Public/blob/main/BackRestoreStartmenu/collage.png" width = "400" height = "450" alt="GUI demo" align=center />

### 重要更新 0.6.1
0.5-beta和0.6.0两个版本存在[当路径有空格就无法备份快捷方式的bug]  
见此问题 [issue](https://github.com/Yuphiz/BaRestore_Startmenu/issues/4#issue-1218504890) 感谢[Vectorsmiracle](https://github.com/Vectorsmiracle) 提交此问题  
特征是备份文件缺少zip压缩包  

这个版本现已修复  
十分抱歉对于前两个版本造成的开始菜单快捷方式没有备份  

### 更新 0.6
1.[增加]更新重启资源管理器脚本至v0.5  
2.[修改]当自动备份改为0时，直接删除任务计划，而不是禁用（不过保留了删除任务计划的入口）  
3.[增加]在某些ome等自定义系统下还有可能出现startlayout.json，顺便备份  
4.[修改]缩小窗口  
5.[增加]增加一些悬浮提示  
6.[修改]优化一个关闭异步提示循环进程，查找到后就马上关闭for  
7.[修复]修复var outFile = Nothing  
8.[修复]修复当快速拖动窗口会不能移动窗口的bug  
9.[修复] 从拖动放大拉回后再点放大窗口按钮有个放大窗口位置不对的bug  
10.[修复]修复提示任务计划不存在的多余提示bug  
11.[修复]修复，当拖动窗口时，不会实时缩放的bug  
12.一些代码优化和文字提示改进  

### 更新 Beta 0.5  
    gui用hta写，如果你是精简系统，请自行确认有没有系统有没有wscript、mshta、powershell  
	支持win11正式版和dev版分组开始菜单（全网独家）      
	01.[增加]，开放自动清理备份  
	02.[增加]，管理备份入口（打开备份的文件夹）  
	03.[增加]，支持备份任务栏（只支持快捷方式.部分按钮.部分win10的工具栏，还有部分传统explorer的设置）  
	04.[增加]，改进快捷方式备份desktop.ini，虽然不备份这个也不影响使用  
	05.[增加]，新版gui，不用再键盘输入，直接可点  
	06.[增加]，gui支持自动切换浅色/暗色  
	07.[增加]，GUI适配高分屏  
	08.[增加]，改进用户设置，把设置保存成文件，方便升级，0.4以前的版本请重新设置  
	09.[增加]，文件名加入系统版本号和是否备份了任务栏，如果备份了任务栏，文件名会有WithTarkBar关键词，文件名所示如下  
	计算机名_用户名_时间戳_WithTaskBar_Os系统版本号_AutoBakvp  
		WithTaskBar表示备份了任务栏，AutoBakvp表示是自动备份  
	10.[增加]，当填写备份path没写盘符时，自动加上脚本当前路径前缀  
	11.[增加]，检测还原文件夹是否包括还原所需的文件  
	12.[增加]，增加一键重启再打开文件夹按钮  
	13.[修复]，重新载入(刷新)选择还原的文件夹时，还原模式不对，会丢失参数，导致还原模式不对  
	15.[修复]，当用脚本的用户不是管理员，获取用户名是管理员，导致还原前的备份.还原个人快捷方式路径错误。  
	[其他]，因为现在我的主力是win11，所以放弃支持tile genie磁贴美化软件，如果多人需要再看要不要加进去，有思路，懒得加进去  
  
#### beta v0.5 已知问题  
	1.win11上，如果迁移了系统（重装等），遇到任务计划程序不能还原，这个问题只有在不是同一个用户的系统时出现  
	2.win10上，如果软件未安装，有极少的磁贴不能还原，不用担心，重新安装软件会自动出现  
	3.win10上，ltsc系统，因为默认没有磁贴，所以重置开始菜单之后会有空白分组，不用担心，重启资源管理器就好了  
	4.自动清理备份文件判断日期是文件夹的最后修改时间，所以没事别乱改备份文件夹  
	5.不能备份还原uwp的自定义美化磁贴（比如tile genie之类的），有思路，但是用户量少，本人也不用，所以暂时不加进去  
  
<br>
<br>

#### 更新    Alpha 0.2    
	1.[增加] 更新支持旧版系统（1703及以后的系统都支持）  
	2.[增加] 增加不支持的系统提示，如果系统版本过低会提示   
	3.[增加] 增加自由选择还原文件夹的选项  
	4.[增加] 增加如果开启了还原前备份功能，重置开始菜单时会自动备份一个  
	5.[修复] 修复因为还原前的自动备份已存在，导致脚本在后台一直停留需要应答
	6.[修复] 优化部分代码  
	7.[修复] 修复用户shell文件夹没有  DefaultLayouts.xml的时候脚本报错  
		8. [修复] 修复低版本系统重置开始菜单不完全  
  
	1703以前的系统不支持，1703及以后的系统支持，1089以前和1089及以后的备份文件不通用，低于17744要删xml  

	支持系统：Windows10 1703及以后的版本
  
#### 已知问题  
	1.如果软件未安装，有极少的磁贴不能还原，不用担心，重新安装软件会自动出现  
	2.ltsc系统，因为默认没有磁贴，所以重置开始菜单之后会有空白分组，不用担心，重启资源管理器就好了  
	3.当用脚本的用户不是管理员，使用【还原2.4】还原前的自动备份会变成管理员的（已修复）  
	4.自动清理备份文件判断日期是文件夹的最后修改时间，所以没事别乱改备份文件夹，最好改成判断文件修改日期逻辑，但是layout.xml万年是那个日期  
	5.不能备份还原uwp的自定义美化磁贴（比如tile genie之类的）  


个人开发不易，如果觉得解决了你的问题，请捐赠支持开发者。你的支持将会让工具越来越好。
![image](https://github.com/Yuphiz/Public/blob/main/Yuphiz_Pay.jpg)
