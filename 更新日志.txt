更新 0.6.2
见此issue，https://github.com/Yuphiz/BaRestore_Startmenu/issues/5，有些旧的win10版本没有深浅色主题，或者有些人删掉了这个注册表，这个版本是修复没有此注册表的报错



重要更新 0.6.1
0.5-beta和0.6.0两个版本存在[当路径有空格就无法备份快捷方式的bug]
见此问题 issue 感谢Vectorsmiracle 提交此问题
特征是备份文件缺少zip压缩包

这个版本现已修复
十分抱歉对于前两个版本造成的开始菜单快捷方式没有备份


更新 0.6
1.[增加]更新重启资源管理器脚本至v0.5
2.[修改]当自动备份改为0时，直接删除任务计划，而不是禁用（不过保留了删除任务计划的入口）
3.[增加]在某些ome等自定义系统下还有可能出现startlayout.json，顺便备份
4.[修改]缩小窗口
5.[增加]增加一些悬浮提示
6.[修改]优化一个关闭异步提示循环进程，查找到后就马上关闭for
7.[修复]修复var outFile = Nothing
8.[修复]修复当快速拖动窗口会不能移动窗口的bug
9.[修复] 从拖动放大拉回后再点放大窗口按钮有个放大窗口位置不对的bug
10.[修复]修复提示任务计划不存在的多余提示bug
11.[修复]修复，当拖动窗口时，不会实时缩放的bug
12.一些代码优化和文字提示改进






更新    Beta 0.5
	gui用hta写，如果你是精简系统，请自行确认有没有系统有没有wscript、mshta、powershell
	支持win11正式版和dev版分组开始菜单（全网独家）
	01、[增加]，开放自动清理备份
	02、[增加]，管理备份入口（打开备份的文件夹）
	03、[增加]，支持备份任务栏（只支持快捷方式、部分按钮、部分win10的工具栏，还有部分传统explorer的设置）
	04、[增加]，改进快捷方式备份desktop.ini，虽然不备份这个也不影响使用
	05、[增加]，新版gui，不用再键盘输入，直接可点
	06、[增加]，gui支持自动切换浅色/暗色
	07、[增加]，GUI适配高分屏
	08、[增加]，改进用户设置，把设置保存成文件，方便升级，0.4以前的版本请重新设置
	09、[增加]，文件名加入系统版本号和是否备份了任务栏，如果备份了任务栏，文件名会有WithTarkBar关键词，文件名所示如下
		计算机名_用户名_时间戳_WithTaskBar_Os系统版本号_AutoBakvp
		WithTaskBar表示备份了任务栏，AutoBakvp表示是自动备份
	10、[增加]，当填写备份path没写盘符时，自动加上脚本当前路径前缀
	11、[增加]，检测还原文件夹是否包括还原所需的文件
	12、[增加]，增加一键重启再打开文件夹按钮
	13、[修复]，重新载入(刷新)选择还原的文件夹时，还原模式不对，会丢失参数，导致还原模式不对
	15、[修复]，当用脚本的用户不是管理员，获取用户名是管理员，导致还原前的备份、还原个人快捷方式路径错误。
	[其他]，因为现在我的主力是win11，所以放弃支持tile genie磁贴美化软件，如果多人需要再看要不要加进去，有思路，懒得加进去


#### beta v0.5 已知问题  
	1.win11上，如果迁移了系统（重装等），遇到任务计划程序不能还原，这个问题只有在不是同一个用户的系统时出现  
	2.win10上，如果软件未安装，有极少的磁贴不能还原，不用担心，重新安装软件会自动出现  
	3.win10上，ltsc系统，因为默认没有磁贴，所以重置开始菜单之后会有空白分组，不用担心，重启资源管理器就好了  
	4.自动清理备份文件判断日期是文件夹的最后修改时间，所以没事别乱改备份文件夹  
	5.不能备份还原uwp的自定义美化磁贴（比如tile genie之类的），有思路，但是用户量少，本人也不用，所以暂时不加进去 



更新    Alpha 0.2  
	1、[增加] 更新支持旧版系统（1703及以后的系统都支持）
	2、[增加] 增加不支持的系统提示，如果系统版本过低会提示
	3、[增加] 增加自由选择还原文件夹的选项
	4、[增加] 增加如果开启了还原前备份功能，重置开始菜单时会自动备份一个
	5、[修复] 修复因为还原前的自动备份已存在，导致脚本在后台一直停留需要应答
	6、[修复] 优化部分代码
	7、[修复] 修复用户shell文件夹没有DefaultLayouts.xml的时候脚本报错
	8、[修复] 修复低版本系统重置开始菜单不完全

	1703以前的系统不支持，1703及以后的系统支持，1089以前和1089及以后的备份文件不通用，低于17744要删xml

	支持系统：Windows10 1703及以后的版本

已知问题
	1、如果软件未安装，有极少的磁贴不能还原，不用担心，重新安装软件会自动出现
	2、ltsc系统，因为默认没有磁贴，所以重置开始菜单之后会有空白分组，不用担心，重启资源管理器就好了
	3、当用脚本的用户不是管理员，使用【还原2.4】还原前的自动备份会变成管理员的（已修复）
	4、自动清理备份文件判断日期是文件夹的最后修改时间，所以没事别乱改备份文件夹，最好改成判断文件修改日期逻辑，但是layout.xml万年是那个日期
	5、不能备份还原uwp的自定义美化磁贴（比如tile genie之类的）
	6、800x600分辨略下初次打开窗口布局错误
	7、GUI上备份位置和还原包位置偏左




备忘：
后续版本更新预告
1、增加操作状态栏，减少弹窗
2、考虑增加对tile genie的支持
3、优化代码
4、美化GUI、增加icon等
5、支持%%环境变量路径
6、考虑增加组策略的还原模式
7、检测系统是否包含所需文件
8、写关于、捐赠
9、增加主题颜色选择（深色/浅色/跟随系统）
10、修复var outFile = Nothing（已修复）
11、不知道unicode路径支不支持
12、增加检测更新版本、增加下载更新
13、mshta有运行半天无启动的bug，系统bug，和程序无关
14、如果调用com组件失败的，只能用powershell去解压了，但是自带的解压会把隐藏文件的隐藏属性关闭，只能是先读取属性，然后解压后还原属性.检测注册dll/zipfile.dll文件
15、增加创建可以pin到其他位置的快捷方式
16、增加维护祖国统一彩蛋
17、从拖动放大拉回后再点放大窗口按钮有个放大窗口位置不对的bug
18、在某些ome等自定义系统下还有可能出现startlayout.json，顺便备份
19、修复提示任务计划不存在的bug
20、支持相对路径的父级写法



这些变动就需要更新任务计划
触发日期
操作参数
是否禁用
是否备份任务栏

这些设置需要自动生成一份自动备份
第一次设置自动备份的任务计划
以后，从禁用改为开启时，也自动生成一份

保存设置按钮和备份、还原按钮都链接到一个函数
1、判断是点击按钮从哪里来的，
2、如果来自保存设置，则仅仅判断是否需要更新任务计划，判断是否更新任务计划不在save函数，而在runmain函数，判断完是否要更新任务计划后，如果需要就调用主vbs脚本，最后退出
备份和还原按钮则
3、重复1和2，
4、判断是备份还是还原，然后调用主vbs脚本



支持tile genie有两种方法，两种方法都需要备份图片，不同的是，一种需要安装tile genie，一种不需要安装tile genie，但是需要有自带的照片应用，原理是把tile genie快捷方式都转移为照片。还原的时候，工具会自动检测有没有装 tile genie，有装就用第一种方法，没有装就用第二种方法
如果发现第二种方法存在其他的磁贴还原不完整的情况，可以安装回tile genie，此时会自动用第一种方法
调用照片应用原理是编辑照片的xml


还原的图片在【C:\Users\ytikx844tg\AppData\Local\Packages\Microsoft.Windows.Photos_8wekyb3d8bbwe\LocalState】的images下，正个images文件夹都可以删除，如果照片应用重置，图片也会丢失
